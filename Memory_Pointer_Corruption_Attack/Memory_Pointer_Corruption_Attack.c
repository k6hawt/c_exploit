/*
- about
  - program which is vulnerable for Memory Pointer Corruption Attack

- compile
  - $ gcc -g -fno-stack-protector mpc.c

- run
  - $ ./a.out
  - $ gdb a.out

- debug example
  - (gdb) break foo
  - (gdb) run `python -c "print 'B'*4 + 'A'*92 + '40f4ffbf'.decode('hex')"`
  - (gdb) x/100wx $esp
  - (gdb) next
 */

#include <stdio.h>
#include <string.h>

void foo(char *msg)
{
    char buf[80] = "";
    strcpy(buf, msg);
    strcpy(msg, buf);
}

int main(int argc, char *argv[])
{
    char message[100] = "";
    strcpy(message, argv[1]);
    foo(message);
    return 0;
}
